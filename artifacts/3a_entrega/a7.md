# A7: High-level architecture. Privileges. Web resources specification

**Re-Event** is an event management platform that allows users to create and join events, based on their personal interests.

The design of the applying is documented indicating the catalogue of resources and therefore the properties of every resource, including: references to the graphical interfaces, and therefore the format of JSON responses. This physical object presents the documentation as well as the CRUD operations.

# 1. Overview

The modules of the application are identified and briefly described with the web resources associated in the individual documentation.

|                                            |                                                                            |
| ------------------------------------------ | -------------------------------------------------------------------------- |
| **M01: Authentication and User Profile**   | Web resources associated with user profile info and authentication.        |
| **M02: Event Management**                  | Web resources related to searching, creating and editing events.           |
| **M03: Event Participation and Ownership** | Web resources related to participating on events and listing events owned. |
| **M04: Review and Comment**                | Web resources related to reviewing and commenting events.                  |
| **M05: Administration and Static Pages**   | Web resources related to administration actions and static pages           |

## 2. Permissions

The permissions utilized in the modules to ascertain the conditions of access to resources are included in this section.

|          |        |                                                                                 |
| -------- | ------ | ------------------------------------------------------------------------------- |
| **PUB**  | Public | No privileges                                                                   |
| **AUTH** | User   | Authenticated users                                                             |
| **OWN**  | Owner  | Users that are owners of information (Event hosts, profile, comments / reviews) |
| **ADM**  | Admin  | Administrators                                                                  |

## 3. Modules

### M01: Authentication and Profile

-   R101: Login form (/login)
-   R102: Login action (/login)
-   R103: Login action (/logout)
-   R104: Sign up form (/registration)
-   R105: Sign up action (/registration)
-   R106: View profile page (/profile/{id})
-   R107: Edit profile form (/profile/{id}/edit)
-   R108: Edit profile action (/profile/{id}/edit)

#### R101: Login Form

|                 |                                                 |     |
| --------------- | ----------------------------------------------- | --- |
| **URL**         | `/login`                                        |     |
| **Description** | Form page that allows user login.               |     |
| **Method**      | GET                                             |     |
| **UI**          | [login](../../imagens_artifacts/login_page.png) |     |
| **SUBMIT**      | [R102](#r102-login-action)                      |     |
| **Permissions** | PUB                                             |     |

#### R102: Login Action

|                  |                                                            |          |
| ---------------- | ---------------------------------------------------------- | -------- |
| **URL**          | `/login`                                                   |          |
| **Description**  | Web Resource that verifies user input to authenticate him. |          |
| **Method**       | POST                                                       |          |
| **Request Body** | +email: string                                             | Email    |
|                  | +password: string                                          | Password |
| **Redirects**    | [Home Page](../../imagens_artifacts/home_page.png)         | Success  |
|                  | [Login Page](../../imagens_artifacts/login_page.png)       | Error    |
| **Permissions**  | PUB                                                        |          |

#### R103: Logout Action

|                 |                                                    |     |
| --------------- | -------------------------------------------------- | --- |
| **URL**         | `/logout`                                          |     |
| **Description** | Web resource that logs out the user.               |     |
| **Method**      | POST                                               |     |
| **SUBMIT**      | [Home Page](../../imagens_artifacts/home_page.png) |     |
| **Permissions** | AUTH, ADM                                          |     |

#### R104: Sign Up Form

|                 |                                                                         |     |
| --------------- | ----------------------------------------------------------------------- | --- |
| **URL**         | `/registration`                                                         |     |
| **Description** | Form page that allows user to register themselves into the application. |     |
| **Method**      | GET                                                                     |     |
| **UI**          | [Register Page](../../imagens_artifacts/register_page.png)              |     |
| **SUBMIT**      | [R105](#r105-sign-up-action)                                            |     |
| **Permissions** | PUB                                                                     |     |

#### R105: Sign Up Action

|                  |                                                      |                 |
| ---------------- | ---------------------------------------------------- | --------------- |
| **URL**          | `/register`                                          |                 |
| **Description**  | This web resource register the user into the system. |                 |
| **Method**       | POST                                                 |                 |
| **Request Body** | +name: string                                        | Name            |
|                  | +email: string                                       | Email           |
|                  | +birthdate: date                                     | Birthdate       |
|                  | +password: string                                    | Password        |
|                  | +confirmPassword: string                             | confirmPassword |
|                  | +gender: Genders                                     | Gender          |
|                  | +profilePic: string                                  | profilePic      |
| **Redirects**    | [R101](#r101-login-form)                             | Success         |
|                  | [R104](#r104-sign-up-form)                           | Error           |
| **Permissions**  | PUB                                                  |                 |

#### R106: View Profile

|                 |                       |                  |
| --------------- | --------------------- | ---------------- |
| **URL**         | `/profile/{id}`       |                  |
| **Description** | User profile page.    |                  |
| **Method**      | GET                   |                  |
| **Parameters**  | +userID: integer      | user primary key |
| **UI**          | **User Profile Page** |                  |
| **Permissions** | OWN                   |                  |

#### R107: Edit Profile Form

|                 |                                   |                  |
| --------------- | --------------------------------- | ---------------- |
| **URL**         | `/profile/{id}/edit`              |                  |
| **Description** | User edit profile page.           |                  |
| **Method**      | GET                               |                  |
| **Parameters**  | +id: integer                      | user primary key |
| **UI**          | **User Profile Edit Page**        |                  |
| **SUBMIT**      | [R108](#r108-edit-profile-action) |                  |
| **Permissions** | OWN                               |                  |

#### R108: Edit Profile Action

|                  |                                                                           |                  |
| ---------------- | ------------------------------------------------------------------------- | ---------------- |
| **URL**          | `/profile/{id}/edit`                                                      |                  |
| **Description**  | This web resource allows the user to change it's user profile information |                  |
| **Method**       | PUT                                                                       |                  |
| **Parameters**   | +userID: integer                                                          | user primary key |
| **Request Body** | ?name: string                                                             | Name             |
|                  | ?profilePicture: string                                                   | Profile Picture  |
|                  | ?password: string                                                         | Password         |
|                  | ?confirmPassword: string                                                  | confirmPassword  |
|                  | ?birthdate: date                                                          | Birthdate        |
|                  | ?gender: Genders                                                          | Gender           |
| **Redirects**    | [R106](#r106-view-profile)                                                | Success          |
|                  | [R107](#r107-edit-profile-form)                                           | Error            |
| **Permissions**  | OWN                                                                       |                  |

### Module M02 : Search Event

-   R201 - Home _/home_
-   R202 - Search Event _/event_
-   R204 - View Event _/event/{id}_
-   R205 - Create Event Form _/profile/{id}/create_
-   R206 - Create Event Action _/profile/{id}/create_
-   R207 - Edit Event Form _/event/{id}/edit_
-   R208 - Edit Event Action _/event/{id}/edit_
-   R209 - Delete Event _/event/{id}/_

#### R201: Home Page

|                 |                                                   |               |
| --------------- | ------------------------------------------------- | ------------- |
| **URL**         | `/home`                                           |               |
| **Description** | There is a form to search events on the homepage. |               |
| **Method**      | GET                                               |               |
| **Parameters**  | ?query: string                                    | event name    |
|                 | ?city: string                                     | event city    |
|                 | ?country: string                                  | event country |
|                 | ?date: date                                       | event date    |
| **UI**          | [Home](../../imagens_artifacts/home_page.png)     |               |
| **Redirects**   | [R202](#r202-search-events)                       | Success       |
| **Permissions** | PUB                                               |               |

#### R202: Search Events

|                 |                                   |               |
| --------------- | --------------------------------- | ------------- |
| **URL**         | `/search`                         |               |
| **Description** | Page with an event search form    |               |
| **Method**      | GET                               |               |
| **Parameters**  | ?query: string                    | event         |
|                 | ?city: string                     | event city    |
|                 | ?country: string                  | event country |
|                 | ?date: date                       | event date    |
|                 | ?tag: string                      | event tag     |
| **UI**          | Popup with search bar and results |               |
| **AJAX Calls**  | [R203](#r203-search-events-api)   |               |
| **Permissions** | PUB                               |               |

#### R203: Search Events API

|                   |                                                         |                     |
| ----------------- | ------------------------------------------------------- | ------------------- |
| **URL**           | `/api/search`                                           |                     |
| **Description**   | This web resource search events and returns the results |                     |
| **Method**        | GET                                                     |                     |
| **Parameters**    | ?query: string                                          | name or description |
|                   | ?location: string                                       | event location      |
|                   | ?date: date                                             | event date          |
|                   | ?tag: string                                            | event tag           |
| **Response Body** | [JSON 401](#json-401-search-events)                     |                     |
| **Permissions**   | PUB                                                     |                     |

#### R204: View Event

|                 |                                                      |                  |
| --------------- | ---------------------------------------------------- | ---------------- |
| **URL**         | `/event/{id}`                                        |                  |
| **Description** | Displays info about an Event.                        |                  |
| **Method**      | GET                                                  |                  |
| **Parameters**  | +id: integer                                         | user primary key |
| **UI**          | [Event Page](../../imagens_artifacts/event_page.png) |                  |
| **Permissions** | PUB                                                  |                  |

#### R205: Create Event Form

|                 |                                   |     |
| --------------- | --------------------------------- | --- |
| **URL**         | `/profile/{id}/create`            |     |
| **Description** | Page with the event creating form |     |
| **Method**      | GET                               |     |
| **UI**          | **Event Creating Page**           |     |
| **SUBMIT**      | [R206](#r206-create-event-action) |     |
| **Permissions** | AUTH                              |     |

#### R206: Create Event Action

|                  |                                     |                       |
| ---------------- | ----------------------------------- | --------------------- |
| **URL**          | `/profile/{id}/create`              |                       |
| **Description**  | This web resource creates an event. |                       |
| **Method**       | POST                                |                       |
| **Parameters**   | +eventID: integer                   | table primary key     |
| **Request Body** | +name: string                       | event name            |
|                  | +description: string                | event description     |
|                  | +capacity: integer                  | event number of spots |
|                  | +date: date                         | event date            |
|                  | +price: float                       | event price           |
|                  | +isPrivate: bool                    | event privacy         |
| **Redirects**    | [R204](#r204-view-event)            | Success               |
|                  | [R205](#r205-create-event-form)     | Error                 |
| **Permissions**  | AUTH, OWN                           |                       |

#### R207: Edit Event Form

|                 |                                 |                  |
| --------------- | ------------------------------- | ---------------- |
| **URL**         | `/event/{id}/edit`              |                  |
| **Description** | Edit event form.                |                  |
| **Method**      | GET                             |                  |
| **Parameters**  | +id: integer                    | user primary key |
| **UI**          | N/A                             |                  |
| **SUBMIT**      | [R208](#r208-edit-event-action) |                  |
| **Permissions** | OWN, ADM                        |                  |

#### R208: Edit Event Action

|                  |                                     |                       |
| ---------------- | ----------------------------------- | --------------------- |
| **URL**          | `/event/{id}/edit`                  |                       |
| **Description**  | This web resource creates an event. |                       |
| **Method**       | PUT                                 |                       |
| **Parameters**   | +id: integer                        | user primary key      |
| **Request Body** | ?name: string                       | event name            |
|                  | ?description: string                | event description     |
|                  | ?capacity: integer                  | event number of spots |
|                  | ?date: date                         | event date            |
|                  | ?price: float                       | event price           |
|                  | ?isPrivate: bool                    | event privacy         |
| **Redirects**    | [R204](#r204-view-event)            | Success               |
|                  | [R207](#r207-edit-event-form)       | Error                 |
| **Permissions**  | OWN                                 |                       |

#### R209: Delete Event

|                 |                                      |                                                |
| --------------- | ------------------------------------ | ---------------------------------------------- |
| **URL**         | `/event/{id_event}/`                 |                                                |
| **Description** | This webs resource deletes an event. |                                                |
| **Method**      | DELETE                               |                                                |
| **Parameters**  | +id_event: integer                   | event primary key                              |
| **Returns**     | **200 OK**                           | Success                                        |
|                 | **400 Bad Request**                  | Error: HTTP header error message               |
|                 | **404 Not Found**                    | Error: There's no event with the specified id. |
| **Permissions** | OWN, ADM                             |                                                |

### Module M03 : Event Participation

-   R301 - My Events _/profile/{id}_
-   R302 - My Participations _/profile/{id}_
-   R303 - Participate _/event/{id_event}_
-   R304 - Cancel Participation _/event/{id_event}_

#### R301: My Events

|                 |                                                 |                  |
| --------------- | ----------------------------------------------- | ---------------- |
| **URL**         | `/profile/{id}/`                                |                  |
| **Description** | Get events that the User are currently managing |                  |
| **Method**      | GET                                             |                  |
| **Parameters**  | +userID: integer                                | user primary key |
| **UI**          | **User Profile Page with Event List Open**      |                  |
| **Permissions** | OWN                                             |                  |

#### R302: My Participations

|                 |                                                                              |                  |
| --------------- | ---------------------------------------------------------------------------- | ---------------- |
| **URL**         | `/profile/{id}/`                                                             |                  |
| **Description** | Get list of user participation in events that the user is currently managing |                  |
| **Method**      | GET                                                                          |                  |
| **Parameters**  | +userID: integer                                                             | user primary key |
| **UI**          | **User Profile Page with Event List Open**                                   |                  |
| **Permissions** | AUTH                                                                         |                  |

#### R303: Participate

|                  |                                                 |                                          |
| ---------------- | ----------------------------------------------- | ---------------------------------------- |
| **URL**          | `/event/{id_event}/`                            |                                          |
| **Description**  | This webs resource confirms user participation. |                                          |
| **Method**       | POST                                            |                                          |
| **Parameters**   | +userID: integer                                | user primary key                         |
| **Request Body** | +eventID: integer                               | event primary key                        |
| **Returns**      | 200 OK                                          | Success                                  |
|                  | 400 Bad Request                                 | Error: Error message via HTTP header     |
|                  | 404 Not Found                                   | Error: No event with specified ID exists |
| **Permissions**  | AUTH                                            |                                          |

#### R304: Cancel Event Confirmation

|                 |                                                              |                                          |
| --------------- | ------------------------------------------------------------ | ---------------------------------------- |
| **URL**         | `/event/{id_event}/`                                         |                                          |
| **Description** | This webs resource cancel user participation in a set event. |                                          |
| **Method**      | DELETE                                                       |                                          |
| **Parameters**  | +userID: integer                                             | user primary key                         |
|                 | +eventID: integer                                            | event primary key                        |
| **Returns**     | 200 OK                                                       | Success                                  |
|                 | 400 Bad Request                                              | Error: Error message via HTTP header     |
|                 | 404 Not Found                                                | Error: No event with specified id exists |
| **Permissions** | AUTH                                                         |                                          |

### Module M04 : Review and Comment

-   R401 - Add Review _/event/{id}_
-   R402 - View Comment _/event/{id}_
-   R403 - Add Comment _/event/{id_event}_
-   R404 - Delete Comment _/event/{id_event}_

#### R401: Add Review

|                  |                                   |                                          |
| ---------------- | --------------------------------- | ---------------------------------------- |
| **URL**          | `/event/{id}`                     |                                          |
| **Description**  | This web resources adds a review. |                                          |
| **Method**       | POST                              |                                          |
| **Parameters**   | +eventID: integer                 | event primary key                        |
| **Request Body** | +rating: integer                  | rating 0..5                              |
| **Returns**      | 200 OK                            | Success                                  |
|                  | 400 Bad Request                   | Error: Error message via HTTP header     |
|                  | 404 Not Found                     | Error: No event with specified ID exists |
| **Permissions**  | AUTH                              |                                          |

#### R402: View Comment

|                   |                                     |                   |
| ----------------- | ----------------------------------- | ----------------- |
| **URL**           | `/event/{id}`                       |                   |
| **Description**   | Get all event comments.             |                   |
| **Method**        | GET                                 |                   |
| **Parameters**    | +eventID: integer                   | event primary key |
| **Response Body** | [JSON 403](#json-403-view-comments) |                   |
| **Permissions**   | PUB                                 |                   |

#### R403: Add Comment

|                  |                                    |                                          |
| ---------------- | ---------------------------------- | ---------------------------------------- |
| **URL**          | `/event/{id_event}`                |                                          |
| **Description**  | This web resources adds a comment. |                                          |
| **Method**       | POST                               |                                          |
| **Parameters**   | +eventID: integer                  | event primary key                        |
| **Request Body** | +userID: integer                   | user id                                  |
|                  | +text: string                      | comment text                             |
| **Returns**      | 200 OK                             | Success                                  |
|                  | 400 Bad Request                    | Error: Error message via HTTP header     |
|                  | 404 Not Found                      | Error: No event with specified id exists |
| **Permissions**  | AUTH                               |                                          |

#### R404: Delete Comment

|                 |                                       |                                         |
| --------------- | ------------------------------------- | --------------------------------------- |
| **URL**         | `/event/{id_event}/`                  |                                         |
| **Description** | This webs resource deletes a comment. |                                         |
| **Method**      | DELETE                                |                                         |
| **Parameters**  | +eventID: integer                     | event primary key                       |
|                 | +commentID: integer                   | comment primary key                     |
| **Returns**     | 200 OK                                | Success                                 |
|                 | 400 Bad Request                       | Error: Error message via HTTP header    |
|                 | 404 Not Found                         | Error: No user with specified id exists |
| **Permissions** | OWN, ADM                              |                                         |

### Module M05 : Administration and Static Pages

-   R501 - About _/about_
-   R502 - FAQ _/faq_
-   R503 - Contacts _/contact_
-   R504 - Get Users _/admin/users_
-   R506 - Get reports _/admin/reports_
-   R507 - Ban/Delete User _/admin/users/{id}_
-   R508 - Delete Comment _/admin/comments/{id}_

#### R501: About

|                 |                |     |
| --------------- | -------------- | --- |
| **URL**         | `/about`       |     |
| **Description** | About Page     |     |
| **Method**      | GET            |     |
| **UI**          | Currently none |     |
| **Permissions** | PUB            |     |

#### R502: FAQ

|                 |                |     |
| --------------- | -------------- | --- |
| **URL**         | `/faq`         |     |
| **Description** | FAQ Page       |     |
| **Method**      | GET            |     |
| **UI**          | Currently none |     |
| **Permissions** | PUB            |     |

#### R503: Contacts

|                 |                 |     |
| --------------- | --------------- | --- |
| **URL**         | `/contacts`     |     |
| **Description** | Contact Us Page |     |
| **Method**      | GET             |     |
| **UI**          | Currently none  |     |
| **Permissions** | PUB             |     |

#### R504: Get users

|                   |                                     |     |
| ----------------- | ----------------------------------- | --- |
| **URL**           | `admin/users`                       |     |
| **Description**   | Page listing all Users              |     |
| **Method**        | GET                                 |     |
| **Response Body** | [JSON 402](#json-402-search-users) |     |
| **UI**            | Currently none                      |     |
| **Permissions**   | ADM                                 |     |

#### R505: Get reports

|                 |                      |     |
| --------------- | -------------------- | --- |
| **URL**         | `admin/reports`      |     |
| **Description** | Get all reports page |     |
| **Method**      | GET                  |     |
| **UI**          | Currently none       |     |
| **Permissions** | ADM                  |     |

#### R506: Ban/Delete User

|                 |                                         |                                         |
| --------------- | --------------------------------------- | --------------------------------------- |
| **URL**         | `admin/users/{id}/`                     |                                         |
| **Description** | This webs resource bans/deletes a user. |                                         |
| **Method**      | DELETE                                  |                                         |
| **Parameters**  | +userID: integer                        | user primary key                        |
| **Returns**     | 200 OK                                  | Success                                 |
|                 | 400 Bad Request                         | Error: Error message via HTTP header    |
|                 | 404 Not Found                           | Error: No user with specified id exists |
| **Permissions** | ADM                                     |                                         |

#### R507: Delete Comment

|                 |                                      |                                            |
| --------------- | ------------------------------------ | ------------------------------------------ |
| **URL**         | `admin/comments/{id}/`               |                                            |
| **Description** | This webs resource deletes a comment |                                            |
| **Method**      | DELETE                               |                                            |
| **Parameters**  | +commentID: integer                  | comment primary key                        |
| **Returns**     | 200 OK                               | Success                                    |
|                 | 400 Bad Request                      | Error: Error message via HTTP header       |
|                 | 404 Not Found                        | Error: No comment with specified id exists |
| **Permissions** | ADM                                  |                                            |

## 4. JSON / XML Types

JSON formats are expected to be as documented below:

### JSON 401: Search Events

e.g. Pesquisa por "Grand Prix"

```json
{
    "event": [
        {
            "eventID": 1,
            "name": "Grand Prix de São Paulo 2022",
            "description": "Uma das corridas mais tradicionais do calendário do F1, o GP de São Paulo é uma das corridas mais disputadas do ano. A pista de Interlagos é uma das mais desafiadoras do calendário, com uma curva de alta velocidade e uma reta longa, que permite ultrapassagens.",
            "capacity": 120000,
            "date": "2022-11-12",
            "price": 1500.0,
            "address": "Pista de Interlagos, São Paulo, SP, Brasil",
            "avg_rating": 4.9,
            "isPrivate": false
        },
        {
            "eventID": 2,
            "name": "Etihad Airways Abu Dhabi Grand Prix 2022",
            "description": "O grand prix de Abu Dhabi é uma das corridas mais disputadas do ano. A pista de Yas Marina é uma das mais desafiadoras do calendário, com uma curva de alta velocidade e uma reta longa, que permite ultrapassagens. A corrida é disputada em um circuito urbano, com a pista passando por dentro do autódromo e por ruas da cidade de Abu Dhabi. A corrida é disputada em um circuito urbano, com a pista passando por dentro do autódromo e por ruas da cidade de Abu Dhabi.",
            "capacity": 120000,
            "date": "2022-12-19",
            "price": 2500.0,
            "address": "Pista de Yas Marina, Abu Dhabi, Emirados Árabes Unidos",
            "avg_rating": 4.2,
            "isPrivate: false,
        }
    ]
}
```

### JSON 402: Search Users

e.g. Pesquisa por "João"

```json
{
    "user": [
        {
            "userID": 1,
            "name": "João Machado",
            "email": "jmachado_1990@gmail.com",
            "birthDate": "1990-12-21",
            "address": "Rua dos Bobos, nº 0, Lisboa, Portugal",
            "gender": "M",
            "profilePic": "/assets/profilePictures/user1.jpg",
            "isAdmin": false
        },
        {
            "userID": 2,
            "name": "Maria João",
            "email": "mary_jane_20@up.pt",
            "birthDate": "2000-12-21",
            "address": "Rua dos Carvalhos, nº 0, Lisboa, Portugal",
            "gender": "F",
            "profilePic": "/assets/profilePictures/user2.jpg",
            "isAdmin": false
    ]
}
```

### JSON 403: View Comments

Search for example for comments in the event Coldplay Coimbra:

```json
{
    "comment": [
        {
            "id": "3",
            "text": "This is way to overpriced!!",
            "date": "2022-05-11",
            "user": "MiguelOliveira931",
            "event": "Coldplay Coimbra"
        },
        {
            "id": "4",
            "text": "I cannot wait for this event!",
            "date": "2022-08-11",
            "user": "Ramalhete21",
            "event": "Coldplay Coimbra"
        }
    ]
}
```

**GROUP2291, 24/10/2022**

-   Afonso Jorge Farroco Martins, [up202005900@fe.up.pt](mailto:up202005900@fe.up.pt)
-   Eduardo Filipe Leite da Silva, [up202005283@fe.up.pt](mailto:up202005283@fe.up.pt)
-   José Diogo Pinto, [up202003529@fe.up.pt](mailto:up202003529@fe.up.pt)
-   Matilde Maria Amaral Silva, [up202007928@fe.up.pt](mailto:up202007928@fe.up.pt)
